<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-size:x-large; color:#333333;">Impressive Solids: делаем игру на C# под OpenGL, часть II</span></p>
<p style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image21896.png" /><img src="http://besisland.name/img/blog/impressive-solids-habr-2.png" style="float: left;" /></p>
<p style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">В </span><a href="http://habrahabr.ru/blogs/gdev/133983/"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#6da3bd;">первой части</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> разработки тетрисоподобной игры Impressive Solids мы реализовали основную часть геймплея, уделив минимальное внимание внешнему виду приложения. Мы и OpenGL-то почти не использовали, всего и делали, что рисовали цветной прямоугольник. Пришла пора заняться оформлением, а также реализовать подсчёт очков и хранение рекорда (high score). Ну что, поехали дальше.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#999999;">Picture This</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Займёмся текстурами. Нам нужно, во-первых, натянуть что-нибудь на фон окна, а во-вторых, сделать приятно выглядящие блоки (сейчас это просто цветные прямоугольники). Понятное дело, сначала надо изготовить текстуры. В этом нам поможет </span><a href="http://www.gimp.org/"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#6da3bd;">GIMP</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Если у вас нет желания заниматься графикой, можете просто скачать</span><a href="http://impressive-solids.googlecode.com/files/alpha2-textures-pot.tar"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#6da3bd;">архив с готовыми текстурами</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и переходить к следующему этапу.<br /><br />Но сперва отмечу один очень важный нюанс. </span><a href="http://www.opengl.org/wiki/NPOT_Texture"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#6da3bd;">До версии OpenGL 2.0</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> каждый из размеров текстуры обязан был быть равным степени двойки (т. е. 64×64, 512×256; это POT-текстуры, от англ. power of two). Если текстуры произвольного размера (NPOT-текстуры) не поддерживаются видеокартой или драйвером видеокарты, такая текстура не будет работать. Это имеет место, например, для встроенных видеокарт Intel под Windows XP.<br /><br />Чтобы гарантированно обезопасить себя от этой проблемы, самое простое и удобное решение — всегда использовать POT-текстуры. Однако это не всегда возможно, и дальше, когда мы дойдём до вывода текста, нам придётся заняться этим моментом.<br /><br /></span><a name="habracut"></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">И</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">так, создаём в GIMP пустое (белое) изображение 512×512, далее: Filters → Artistic → Apply Canvas, затем: Filters → Map → Make Seamless. Всё, background.png готов.<br /><br />Блоки попытаемся изобразить как мраморные шарики, в этом нам </span><a href="http://www.ehow.com/how_5695037_make-marbled-bubble-gimp.html"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#6da3bd;">поможет Дэниел Кетчум</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Создаём прозрачное изображение где-то 300×300, делаем круглое выделение на весь диаметр холста. Инструмент Bucket Fill → Pattern fill → выбираем текстуру Marble #1, заливаем круг. Далее: Filters → Distort → Lens Distortion, крутим Main на максимум, а Edge — на минимум, OK. Затем: Filters → Light and Shadow → Lighting Effects, ставим свет так, чтобы создать эффект трёхмерного шара. Кадрируем, чтобы не было пустых полей. Масштабируем до размера 256×256. Потом при помощи Colors → Colorize делаем пять разных цветов (крутим Hue) и сохраняем как 0.png, 1.png… 4.png (помним, что в игровой модели мы решили обозначать разные цвета блоков целым числом начиная с нуля).<br /><br />Теперь надо занести эти файлы в проект Visual C# Express / MonoDevelop. Сперва через контекстное меню создаём New Folder с именем textures, а в нём — solids. Через файловый менеджер помещаем в textures файл background.png, а в textures/solids — файлы 0.png… 4.png. Через контекстное меню в среде разработки добавляем эти файлы в проект в соответствующие папки.<br /><br />После этого необходимо для всех файлов *.png в проекте открыть Properties и выставить Build Action: Content; Copy to Output Directory: Copy if newer.<br /><br />Задействуем текстуры в OpenGL. Сама OpenGL не оперирует графическими файлами, нужно своими средствами (в этом поможет </span><span style=" font-family:'monospace'; color:#000000;">System.Drawing.Bitmap</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">) загрузить текстуру в память, получить из неё бинарный bitmap и его передать в OpenGL, которая сохранит текстуру уже в своей памяти. В дальнейшем обращаться к текстуре можно будет через целочисленный handle (который сперва надо зарезервировать).<br /><br />Инкапсулируем этот механизм в виде нового класса </span><span style=" font-family:'monospace'; color:#000000;">Texture</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> System;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> System.Drawing;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> System.Drawing.Imaging;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OpenTK.Graphics.OpenGL;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">namespace</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> ImpressiveSolids {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">class</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Texture : IDisposable {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> GlHandle { </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">get</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">set</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Width { </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">get</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">set</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Height { </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">get</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">set</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Texture(Bitmap Bitmap) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GlHandle = GL.GenTexture();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            Bind();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            Width = Bitmap.Width;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            Height = Bitmap.Height;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> BitmapData = Bitmap.LockBits(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Rectangle(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, Bitmap.Width, Bitmap.Height), ImageLockMode.ReadOnly, System.Drawing.Imaging.PixelFormat.Format32bppArgb);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.TexImage2D(TextureTarget.Texture2D, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, PixelInternalFormat.Rgba, BitmapData.Width, BitmapData.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, OpenTK.Graphics.OpenGL.PixelFormat.Bgra, PixelType.UnsignedByte, BitmapData.Scan0);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            Bitmap.UnlockBits(BitmapData);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.TexParameter(TextureTarget.Texture2D, TextureParameterName.TextureMinFilter, (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)TextureMinFilter.Linear);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.TexParameter(TextureTarget.Texture2D, TextureParameterName.TextureMagFilter, (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)TextureMagFilter.Linear);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Bind() {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.BindTexture(TextureTarget.Texture2D, GlHandle);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        #region Disposable</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">bool</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Disposed = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">false</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Dispose() {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            Dispose(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">true</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GC.SuppressFinalize(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">this</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">virtual</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Dispose(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">bool</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Disposing) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (!Disposed) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (Disposing) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    GL.DeleteTexture(GlHandle);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                Disposed = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">true</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        ~Texture() {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            Dispose(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">false</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        #endregion</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />В </span><span style=" font-family:'monospace'; color:#000000;">Game</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> загрузим текстуры.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> System.Drawing;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Texture TextureBackground;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Texture[] ColorTextures = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Texture[ColorsCount];</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Game()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    : </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">base</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">(NominalWidth, NominalHeight, GraphicsMode.Default, </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;Impressive Solids&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    VSync = VSyncMode.On;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    Keyboard.KeyDown += </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> EventHandler&lt;KeyboardKeyEventArgs&gt;(OnKeyDown);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    TextureBackground = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Texture(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Bitmap(</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;textures/background.png&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">));</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">for</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> i = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; i &lt; ColorsCount; i++) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        ColorTextures[i] = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Texture(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Bitmap(</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;textures/solids/&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> + i + </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;.png&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">));</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />Изменим рендеринг. Надо включить текстуры в целом, а также режим прозрачности. Затем перед тем, как задать координаты прямоугольника, надо выбрать (bind) соответствующую текстуру. Перед каждой точкой (vertex) надо задать соответствующие координаты текстуры (считается, что (1; 1) — правый нижний угол текстуры).<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">override</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OnLoad(EventArgs E) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">base</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">.OnLoad(E);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Enable(EnableCap.Texture2D);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Enable(EnableCap.Blend);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.BlendFunc(BlendingFactorSrc.SrcAlpha, BlendingFactorDest.OneMinusSrcAlpha);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    New();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">override</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OnRenderFrame(FrameEventArgs E) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.LoadMatrix(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">ref</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Modelview);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    RenderBackground();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">for</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> X = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; X &lt; MapWidth; X++) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">for</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Y = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; Y &lt; MapHeight; Y++) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (Map[X, Y] &gt;= </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                RenderSolid(X, Y + ImpactFallOffset[X, Y], Map[X, Y]);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (GameStateEnum.Fall == GameState) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">for</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> i = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; i &lt; StickLength; i++) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            RenderSolid(StickPosition.X + i, StickPosition.Y, StickColors[i]);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    SwapBuffers();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> RenderBackground() {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    TextureBackground.Bind();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Color4(Color4.White);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Begin(BeginMode.Quads);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.TexCoord2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.TexCoord2((</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">float</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)ClientRectangle.Width / TextureBackground.Width, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(ProjectionWidth, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.TexCoord2((</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">float</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)ClientRectangle.Width / TextureBackground.Width, (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">float</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)ClientRectangle.Height / TextureBackground.Height);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(ProjectionWidth, ProjectionHeight);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.TexCoord2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">float</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)ClientRectangle.Height / TextureBackground.Height);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, ProjectionHeight);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.End();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> RenderSolid(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">float</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> X, </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">float</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Y, </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Color) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    ColorTextures[Color].Bind();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Color4(Color4.White);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Begin(BeginMode.Quads);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.TexCoord2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(X * SolidSize, Y * SolidSize);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.TexCoord2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2((X + </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">) * SolidSize, Y * SolidSize);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.TexCoord2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2((X + </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">) * SolidSize, (Y + </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">) * SolidSize);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.TexCoord2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(X * SolidSize, (Y + </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">) * SolidSize);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.End();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />Заданный цвет как бы окрашивает, тонирует текстуру, поэтому указываем белый цвет.<br /><br />Прекрасно, текстуры работают. Коммитим: «Textured background and solids».<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#999999;">Main Street</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Теперь надо обозначить стакан. Пусть это будет просто чёрный прямоугольник, поверх фона окна, но за блоками.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> RenderPipe() {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Disable(EnableCap.Texture2D);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Color4(Color4.Black);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Begin(BeginMode.Quads);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(MapWidth * SolidSize, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(MapWidth * SolidSize, MapHeight * SolidSize);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, MapHeight * SolidSize);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.End();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Enable(EnableCap.Texture2D);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">override</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OnRenderFrame(FrameEventArgs E) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    RenderBackground();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    RenderPipe();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />Спозиционируем стакан. Пусть он находится слева, с небольшим отступом от краёв окна. Справа от стакана позже разместим дополнительные элементы интерфейса (счёт и т. д.). Однако если окно будет растянуто по ширине, то пусть стакан выдвигается вправо по направлению к центру окна, иначе справа будет слишком много пустого пространства. Напоследок запретим делать окно меньше </span><span style=" font-family:'monospace'; color:#000000;">NominalWidth</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> × </span><span style=" font-family:'monospace'; color:#000000;">NominalHeight</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> (это, правда, не будет работать под X window system).<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">const</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> NominalWidth = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">500</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">const</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> NominalHeight = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">500</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">override</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OnResize(EventArgs E) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (ClientSize.Width &lt; NominalWidth) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        ClientSize = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Size(NominalWidth, ClientSize.Height);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (ClientSize.Height &lt; NominalHeight) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        ClientSize = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Size(ClientSize.Width, NominalHeight);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">override</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OnRenderFrame(FrameEventArgs E) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    RenderBackground();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> PipeMarginY = (ProjectionHeight - MapHeight * SolidSize) / </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">2</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">f;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> PipeMarginX = (NominalHeight - MapHeight * SolidSize) / </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">2</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">f;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Overwidth = ProjectionWidth - ProjectionHeight * (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">float</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)NominalWidth / NominalHeight;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (Overwidth &gt; </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GL.Translate(Math.Min(Overwidth, (ProjectionWidth - MapWidth * SolidSize) / </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">2</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">f), PipeMarginY, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    } </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">else</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GL.Translate(PipeMarginX, PipeMarginY, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    RenderPipe();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />Коммитим: «Position and render pipe».<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#999999;">Writing on the Wall</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Что же будет справа от стакана? Четыре элемента: следующая палка; статус игры (там будет сообщение «Playing», «Paused» или «Game Over»); текущий счёт; рекордный счёт.<br /><br />Большинство из этого — текст, соответственно, нам нужно научиться выводить текст средствами OpenGL. Сама OpenGL ничего такого не умеет. Часто встречаются упоминания о том, будто в OpenTK есть для этой цели удобный класс </span><span style=" font-family:'monospace'; color:#000000;">TextPrinter</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. </span><a href="http://www.opentk.com/project/text"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#6da3bd;">Это было давно</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и неправда. Сейчас </span><a href="http://www.opentk.com/doc/graphics/how-to-render-text-using-opengl"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#6da3bd;">рекомендуемым методом</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> отображения текста является следующий: сделать bitmap с текстом (средствами </span><span style=" font-family:'monospace'; color:#000000;">System.Drawing.Graphics.DrawString</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> или др.) и натянуть её как текстуру.<br /><br />Напишем свой класс </span><span style=" font-family:'monospace'; color:#000000;">TextRenderer</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, который будет создавать </span><span style=" font-family:'monospace'; color:#000000;">Bitmap</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и затем </span><span style=" font-family:'monospace'; color:#000000;">Texture</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> на её основе. Но сначала придётся озаботиться вышеупомянутой проблемой NPOT-размерных текстур, поскольку мы не знаем наперёд, какой размер получится у динамически создаваемой надписи. Метод довольно простой: если NPOT-текстуры не поддерживаются, то надо при загрузке картинки делать POT-размерную текстуру, как бы с полями. Например, если загружаем картинку 300×200, то генерируем текстуру 512×256, на которой в левом верхнем углу будет наша картинка, а остальное пространство будет пустовать. И при накладывании текстуры необходимо будет учесть, что левый нижний угол картинки имеет координаты не (1; 1), а (300/512; 200/256).<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">class</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Texture : IDisposable {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> GlHandle { </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">get</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">set</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Width { </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">get</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">set</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Height { </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">get</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">set</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    #region NPOT</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">static</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">bool</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">? CalculatedSupportForNpot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">static</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">bool</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> NpotIsSupported {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">get</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (!CalculatedSupportForNpot.HasValue) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                CalculatedSupportForNpot = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">false</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> ExtensionsCount;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                GL.GetInteger(GetPName.NumExtensions, </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">out</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> ExtensionsCount);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">for</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> i = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; i &lt; ExtensionsCount; i++) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;GL_ARB_texture_non_power_of_two&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> == GL.GetString(StringName.Extensions, i)) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                        CalculatedSupportForNpot = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">true</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">break</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">return</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> CalculatedSupportForNpot.Value;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> PotWidth {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">get</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">return</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> NpotIsSupported ? Width : (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)Math.Pow(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">2</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, Math.Ceiling(Math.Log(Width, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">2</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)));</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> PotHeight {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">get</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">return</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> NpotIsSupported ? Height : (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)Math.Pow(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">2</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, Math.Ceiling(Math.Log(Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">2</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)));</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    #endregion</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Texture(Bitmap Bitmap) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> BitmapData = Bitmap.LockBits(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Rectangle(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, Bitmap.Width, Bitmap.Height), ImageLockMode.ReadOnly, System.Drawing.Imaging.PixelFormat.Format32bppArgb);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GL.TexImage2D(TextureTarget.Texture2D, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, PixelInternalFormat.Rgba, PotWidth, PotHeight, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, OpenTK.Graphics.OpenGL.PixelFormat.Bgra, PixelType.UnsignedByte, IntPtr.Zero);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GL.TexSubImage2D(TextureTarget.Texture2D, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, BitmapData.Width, BitmapData.Height, OpenTK.Graphics.OpenGL.PixelFormat.Bgra, PixelType.UnsignedByte, BitmapData.Scan0);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        Bitmap.UnlockBits(BitmapData);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />Теперь — </span><span style=" font-family:'monospace'; color:#000000;">TextRenderer</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">. Код кажется длинным, но на самом деле всё просто. Здесь делаем четыре основные вещи: задаём параметры текста, измеряем его размеры, отрисовываем текст в текстуру и, наконец, накладываем текстуру на прозрачный прямоугольник.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> System;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> System.Drawing;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> System.Drawing.Text;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OpenTK.Graphics;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OpenTK.Graphics.OpenGL;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">namespace</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> ImpressiveSolids {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">class</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Font FontValue;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">string</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> LabelValue;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">bool</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> NeedToCalculateSize, NeedToRenderTexture;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Texture Texture;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> CalculatedWidth, CalculatedHeight;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Font Font {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">get</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">return</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> FontValue;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">set</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                FontValue = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">value</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                NeedToCalculateSize = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">true</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                NeedToRenderTexture = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">true</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">string</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Label {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">get</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">return</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> LabelValue;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">set</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">value</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> != LabelValue) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    LabelValue = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">value</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    NeedToCalculateSize = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">true</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    NeedToRenderTexture = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">true</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Width {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">get</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (NeedToCalculateSize) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    CalculateSize();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">return</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> CalculatedWidth;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Height {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">get</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (NeedToCalculateSize) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    CalculateSize();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">return</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> CalculatedHeight;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Color4 Color = Color4.Black;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(Font Font) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">this</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">.Font = Font;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(Font Font, Color4 Color) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">this</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">.Font = Font;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">this</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">.Color = Color;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(Font Font, </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">string</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Label) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">this</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">.Font = Font;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">this</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">.Label = Label;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(Font Font, Color4 Color, </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">string</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Label) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">this</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">.Font = Font;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">this</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">.Color = Color;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">this</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">.Label = Label;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> CalculateSize() {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Bitmap = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Bitmap(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (Graphics Graphics = Graphics.FromImage(Bitmap)) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Measures = Graphics.MeasureString(Label, Font);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    CalculatedWidth = (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)Math.Ceiling(Measures.Width);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    CalculatedHeight = (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)Math.Ceiling(Measures.Height);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            NeedToCalculateSize = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">false</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Render() {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> ((</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">null</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> == Label) || (</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> == Label)) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">return</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (NeedToRenderTexture) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Bitmap = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Bitmap(Width, Height)) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Rectangle = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Rectangle(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, Bitmap.Width, Bitmap.Height);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (Graphics Graphics = Graphics.FromImage(Bitmap)) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                        Graphics.Clear(System.Drawing.Color.Transparent);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                        Graphics.TextRenderingHint = TextRenderingHint.AntiAliasGridFit;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                        Graphics.DrawString(Label, Font, Brushes.White, Rectangle);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">null</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> != Texture) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                            Texture.Dispose();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                        Texture = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Texture(Bitmap);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                NeedToRenderTexture = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">false</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            Texture.Bind();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.Color4(Color);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.Begin(BeginMode.Quads);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.TexCoord2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.Vertex2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.TexCoord2((</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">float</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)Texture.Width / Texture.PotWidth, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.Vertex2(Width, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.TexCoord2((</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">float</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)Texture.Width / Texture.PotWidth, (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">float</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)Texture.Height / Texture.PotHeight);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.Vertex2(Width, Height);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.TexCoord2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">float</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)Texture.Height / Texture.PotHeight);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.Vertex2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, Height);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            GL.End();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />Выведем кое-что справа от стакана.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> System.Drawing.Text;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Score;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> HighScore;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer NextStickLabel, ScoreLabel, ScoreRenderer, HighScoreLabel, HighScoreRenderer, GameOverLabel, GameOverHint;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Game()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> LabelFont = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Font(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> FontFamily(GenericFontFamilies.SansSerif), </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">20</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, GraphicsUnit.Pixel);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> LabelColor = Color4.SteelBlue;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    NextStickLabel = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(LabelFont, LabelColor, </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;Next&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    ScoreLabel = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(LabelFont, LabelColor, </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;Score&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    HighScoreLabel = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(LabelFont, LabelColor, </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;High score&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> ScoreFont = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Font(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> FontFamily(GenericFontFamilies.SansSerif), </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">50</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, GraphicsUnit.Pixel);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> ScoreColor = Color4.Tomato;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    ScoreRenderer = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(ScoreFont, ScoreColor);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    HighScoreRenderer = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(ScoreFont, ScoreColor);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> GameStateFont = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Font(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> FontFamily(GenericFontFamilies.SansSerif), </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">30</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, GraphicsUnit.Pixel);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> GameStateColor = Color4.Tomato;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GameOverLabel = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(GameStateFont, GameStateColor, </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;Game over&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> GameStateHintFont = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Font(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> FontFamily(GenericFontFamilies.SansSerif), </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">25</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, GraphicsUnit.Pixel);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> GameStateHintColor = Color4.SteelBlue;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GameOverHint = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(GameStateHintFont, GameStateHintColor, </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;Press Enter&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">override</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OnRenderFrame(FrameEventArgs E) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Translate(MapWidth * SolidSize + PipeMarginX, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    NextStickLabel.Render();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// TODO вывести собственно next stick</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, MapHeight * SolidSize / </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">4</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">f, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (GameStateEnum.GameOver == GameState) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GameOverLabel.Render();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, GameOverLabel.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GameOverHint.Render();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, -GameOverLabel.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, MapHeight * SolidSize / </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">4</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">f, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    ScoreLabel.Render();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, ScoreLabel.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    ScoreRenderer.Label = Score.ToString();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    ScoreRenderer.Render();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, -ScoreLabel.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, MapHeight * SolidSize / </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">4</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">f, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    HighScoreLabel.Render();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, HighScoreLabel.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    HighScoreRenderer.Label = HighScore.ToString();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    HighScoreRenderer.Render();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    SwapBuffers();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br /></span><span style=" font-family:'monospace'; color:#000000;">MapHeight * SolidSize / 4f</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> — это четверть высоты стакана, мы каждый раз спускаемся ниже на это расстояние, чтобы изобразить один из четырёх элементов интерфейса. Кроме того, выведя надпись, мы спускаемся ниже на её высоту, а затем не забываем подняться обратно к исходной точке.<br /><br />Коммитим: «Text GUI».<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#999999;">Next</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Отобразим собственно следующую палку. Для начала, правда, надо немного изменить модель, потому что сейчас у нас следующая палка генерируется в момент начала следующего хода, а надо, чтобы генерировалась уже на текущем ходу и где-то хранилась.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">[] NextStickColors;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> GenerateNextStick() {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">for</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> i = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; i &lt; StickLength; i++) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        StickColors[i] = NextStickColors[i];</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        NextStickColors[i] = Rand.Next(ColorsCount);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    StickPosition.X = (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">float</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)Math.Floor((MapWidth - StickLength) / </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">2</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">d);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    StickPosition.Y = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> New() {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    StickColors = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">[StickLength];</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    NextStickColors = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">[StickLength];</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GenerateNextStick();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GenerateNextStick(); </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// because 1st call makes current stick all zeros</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GameState = GameStateEnum.Fall;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />Для отображения воспользуемся методом </span><span style=" font-family:'monospace'; color:#000000;">RenderSolid</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, всё очень просто.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">override</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OnRenderFrame(FrameEventArgs E) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    NextStickLabel.Render();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, NextStickLabel.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    RenderNextStick();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, -NextStickLabel.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> RenderNextStick() {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Disable(EnableCap.Texture2D);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Color4(Color4.Black);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Begin(BeginMode.Quads);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(StickLength * SolidSize, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(StickLength * SolidSize, SolidSize);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Vertex2(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, SolidSize);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.End();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Enable(EnableCap.Texture2D);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">for</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> i = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; i &lt; StickLength; i++) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        RenderSolid(i, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, NextStickColors[i]);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />Готово, коммитим: «Render next stick».<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#999999;">The Score</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Займёмся подсчётом очков. Надо давать больше очков за длинные линии, за одновременное уничтожение нескольких линий, за последовательное уничтожение нескольких линий в рамках одного хода. Это заинтересует игроков строить сложные комбинации, добавит игре интереса.<br /><br />Формулы ниже выведены навскидку, их, конечно, надо будет ещё проверить на этапе бета-тестирования, посмотреть на отзывы игроков.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TotalDestroyedThisMove;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> New() {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    Score = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    TotalDestroyedThisMove = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">override</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OnUpdateFrame(FrameEventArgs E) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (Destroyables.Count &gt; </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">foreach</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Coords </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">in</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Destroyables) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            Map[(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)Coords.X, (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)Coords.Y] = -</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        Score += (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">int</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">)Math.Ceiling(Destroyables.Count + Math.Pow(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1.5</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, Destroyables.Count - </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">3</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">) - </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">) + TotalDestroyedThisMove;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        TotalDestroyedThisMove += Destroyables.Count;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        Stabilized = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">false</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GenerateNextStick();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    TotalDestroyedThisMove = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GameState = GameStateEnum.Fall;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />По окончанию игры будем обновлять рекорд (если он побит) и записывать в файл, а при запуске приложения — читать текущий рекорд из файла.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> System.IO;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">string</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> HighScoreFilename;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Game() {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> ConfigDirectory = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + Path.DirectorySeparatorChar + </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;ImpressiveSolids&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (!Directory.Exists(ConfigDirectory)) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        Directory.CreateDirectory(ConfigDirectory);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    HighScoreFilename = ConfigDirectory + Path.DirectorySeparatorChar + </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;HighScore.dat&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (File.Exists(HighScoreFilename)) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Stream = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> FileStream(HighScoreFilename, FileMode.Open)) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Reader = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> BinaryReader(Stream)) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">try</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    HighScore = Reader.ReadInt32();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                } </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">catch</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (IOException) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    HighScore = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    } </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">else</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        HighScore = </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">override</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OnUpdateFrame(FrameEventArgs E) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (GameOver) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GameState = GameStateEnum.GameOver;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (Score &gt; HighScore) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            HighScore = Score;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Stream = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> FileStream(HighScoreFilename, FileMode.Create)) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">using</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Writer = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> BinaryWriter(Stream)) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                    Writer.Write(HighScore);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    } </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">else</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />Коммитим: «Calculating score, storing high score».<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; font-size:large; color:#999999;">Heaven Can Wait</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Напоследок сделаем возможность ставить игру на паузу.<br /><br />Паузу не получится сделать как состояние (</span><span style=" font-family:'monospace'; color:#000000;">GameStateEnum</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">), потому что на паузу можно ставить игру как во время падения палки (</span><span style=" font-family:'monospace'; color:#000000;">Fall</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">), так и во время </span><span style=" font-family:'monospace'; color:#000000;">Impact</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, а из паузы игра должна возвращаться обратно в то состояние, в котором была.<br /><br />Поэтому введём дополнительный флаг </span><span style=" font-family:'monospace'; color:#000000;">Paused</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и его обработку в </span><span style=" font-family:'monospace'; color:#000000;">OnUpdateFrame</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, </span><span style=" font-family:'monospace'; color:#000000;">OnKeyDown</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, </span><span style=" font-family:'monospace'; color:#000000;">OnRenderFrame</span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">.<br /><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">bool</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Paused;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">private</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer PauseLabel, UnpauseHint, PlayingGameLabel, PauseHint;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">public</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Game()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> GameStateFont = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Font(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> FontFamily(GenericFontFamilies.SansSerif), </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">30</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, GraphicsUnit.Pixel);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> GameStateColor = Color4.Tomato;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GameOverLabel = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(GameStateFont, GameStateColor, </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;Game over&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    PauseLabel = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(GameStateFont, GameStateColor, </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;Pause&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    PlayingGameLabel = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(GameStateFont, GameStateColor, </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;Playing&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> GameStateHintFont = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Font(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> FontFamily(GenericFontFamilies.SansSerif), </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">25</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, GraphicsUnit.Pixel);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">var</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> GameStateHintColor = Color4.SteelBlue;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GameOverHint = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(GameStateHintFont, GameStateHintColor, </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;Press Enter&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    UnpauseHint = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(GameStateHintFont, GameStateHintColor, </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;Press Space&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    PauseHint = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">new</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> TextRenderer(GameStateHintFont, GameStateHintColor, </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;Space pauses&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">override</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OnLoad(EventArgs E) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">base</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">.OnLoad(E);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Enable(EnableCap.Texture2D);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Enable(EnableCap.Blend);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.BlendFunc(BlendingFactorSrc.SrcAlpha, BlendingFactorDest.OneMinusSrcAlpha);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    New();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    Paused = </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">true</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">override</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OnUpdateFrame(FrameEventArgs E) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">base</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">.OnUpdateFrame(E);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (Paused) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">return</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OnKeyDown(</span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">object</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> Sender, KeyboardKeyEventArgs E) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> ((GameStateEnum.Fall == GameState) &amp;&amp; !Paused) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (((GameStateEnum.Fall == GameState) || (GameStateEnum.Impact == GameState)) &amp;&amp; (Key.Space == E.Key)) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        Paused = !Paused;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">protected</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">override</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">void</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OnRenderFrame(FrameEventArgs E) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#808080;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, MapHeight * SolidSize / </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">4</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">f, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (GameStateEnum.GameOver == GameState) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GameOverLabel.Render();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, GameOverLabel.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GameOverHint.Render();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, -GameOverLabel.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    } </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">else</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">if</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> (Paused) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        PauseLabel.Render();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, PauseLabel.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        UnpauseHint.Render();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, -PauseLabel.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    } </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">else</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        PlayingGameLabel.Render();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, PlayingGameLabel.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        PauseHint.Render();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        GL.Translate(</span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">, -PlayingGameLabel.Height, </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">// . . .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; color:#000000;"></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /><br />Новую игру при запуске приложения удобно (для игрока) начинать как раз в состоянии паузы.<br /><br />Используем пробел, а не клавишу Pause, потому что пробел расположен удобнее и о нём всегда помнят, в отличие от Pause, про которую многие даже и не знают. Кроме того, с последней возникают проблемы, в частности, при использовании Punto Switcher.<br /><br />Коммитим: «Pause».<br /><br />На этом пока всё. Несомненно, в игре ещё можно доделать много мелких нюансов и частностей. Наверняка всплывут баги, которые нужно будет исправить. Всё это я оставляю читателю на самостоятельное изучение.<br /><br />На </span><a href="http://code.google.com/p/impressive-solids/"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#6da3bd;">сайте проекта</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> (http://code.google.com/p/impressive-solids/) вы сможете </span><a href="http://impressive-solids.googlecode.com/files/ImpressiveSolids-alpha-2.zip"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#6da3bd;">скачать архив (http://impressive-solids.googlecode.com/files/ImpressiveSolids-alpha-2.zip)</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, содержащий состояние игры (исходный код и исполняемый файл) на момент окончания этой статьи, а также получить доступ к репозиторию Mercurial, содержащему в том числе и не вошедшие в статью наработки.</span></p></body></html>