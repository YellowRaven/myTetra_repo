<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-size:x-large; color:#333333;">bash скрипт с поддержкой длинных (gnu-style) опций</span></p>
<p style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><img src="image10603.png" /></p>
<p style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Предстала на первый взгляд тривиальная задача: написать скрипт с различными опциями при запуске. Допустим нужно обработать всего две опции: name и dir. И задача действительно тривиальна при условии, что опции у нас короткие. Но если есть жгучее желание использовать длинные опции, то пиши пропало: getopts, который планировалось использовать изначально, в bash совсем на это не годится. <br /></span><a name="habracut"></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br /></span><span style=" font-family:'Verdana,sans-serif'; color:#000000;">Хотя в ksh всё работает на ура:<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#808080; background-color:#f8f8f8;">#!/bin/ksh</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">while</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> getopts </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;f(file):s(server):&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> flag</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">do</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">echo</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">$flag</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">$OPTIND</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">$OPTARG</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">done</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Но у нас bash, поэтому грустно вздыхаем и пытаемся выбраться из сложившейся ситуации. <br />Вриант парсить самостоятельно с одной стороны привлекателен, но уж слишком скучен и неинтересен: каждый раз нужно думать об обработке ошибок, исключений и многих других вещах. Да и не хочется каждый раз изобретать велосипед, при написании подобного скрипта.<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#808000; background-color:#f8f8f8;">#!/bin/bash</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">while</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">true</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">do</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        case </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">$1</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">in</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            -n | --name ) </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">echo</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> NAME=</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">$2</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; shift </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">2</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            -d | --dir ) </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">echo</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> DIR=</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">$2</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">; shift </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">2</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        esac</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">done</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Можно попробовать использовать getopts с небольшим хаком для поддержки длинных имён:<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#808000; background-color:#f8f8f8;">#!/bin/bash</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">while</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> getopts </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;:n:d:-:&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> OPTION; </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">do</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    case </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">$OPTION</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">in</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        -)  case </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">$OPTARG</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">in</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                name) </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">echo</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> LONG_NAME=</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">${!OPTIND}</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">                dir)  </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">echo</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> LONG_DIR=</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">${!OPTIND}</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> ;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            esac;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        n)  </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">echo</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> SHORT_NAME=</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">$OPTARG</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> ;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        d)  </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">echo</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> SHORT_DIR=</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">$OPTARG</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> ;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    esac</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">done</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Но назвать рабочим такое решение, язык не поворачивается: одновременно поддерживается только одна длинная опция (первая указанная в параметрах), вторая будет проигнорирована. <br /><br />Сетуем, что в bash до сих пор не впилили getopts_long, но гугл подсказывает, что это можно сделать самостоятельно: скачиваем функцию </span><a href="http://stchaz.free.fr/getopts_long"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#6da3bd;">getopts_long</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;"> и включаем её в наш скрипт:<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#808000; background-color:#f8f8f8;">#!/bin/bash</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">. getopts_long</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">while</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> getopts_long :d:n::vh opt \</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    name required_argument \</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    dir required_argument \</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    help </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;$@&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">    </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">do</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        case </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">$opt</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">in</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            n|name) </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">echo</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> NAME=</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">$OPTLARG</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            d|dir) </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">echo</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> DIR=</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">$OPTLARG</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">            help </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">0</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;$@&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">        esac</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">done</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Казалось бы вот оно, счастье, но нашлось ещё более элегантное решение: более продвинутая библиотека</span><a href="http://code.google.com/p/shflags/"><span style=" font-family:'Verdana,sans-serif'; text-decoration: underline; color:#6da3bd;">shflags</span></a><span style=" font-family:'Verdana,sans-serif'; color:#000000;">, которая помимо парсинга опций умеет так же и проверять значения. Различаются строки, логические переменные, целые числа, нецелые числа (по сути это строки, т.к. в шелле нет понятия нецелых чисел, но проверка на правильность формата есть. Определяется это при указании переменных через DEFINE_string|_boolean|_float|_integer и даже самостоятельно обзывает переменные для опций согласно длинному имени опции, так же поддерживает кучу различных шеллов (sh, bash, dash, ksh, zsh). Красота да и только. Более подробно о плюшках можно посмотреть в самой библотеке. Там достаточно подробная справка. Пример использования:<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#808000; background-color:#f8f8f8;">#!/bin/bash</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">. ./shflags</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">DEFINE_string 'name' 'world' 'comment </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">for</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> name' 'n'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">DEFINE_string 'dir' 'dir' 'comment </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">for</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> dir' 'd'</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">FLAGS </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;$@&quot;</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> || </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">exit</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#2f98ff; background-color:#f8f8f8;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;">eval </span><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">set</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> -- </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">${FLAGS_ARGV}</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; color:#4d7386; background-color:#f8f8f8;">echo</span><span style=" font-family:'monospace'; color:#000000; background-color:#f8f8f8;"> </span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;Name is </span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">${FLAGS_name}</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;"> and dir is </span><span style=" font-family:'monospace'; color:#968e5b; background-color:#f8f8f8;">${FLAGS_dir}</span><span style=" font-family:'monospace'; color:#339900; background-color:#f8f8f8;">&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana,sans-serif'; color:#000000;"><br />Однако и в этом решении есть ложка дёгтя: библиотека использует getopt для парсинга опций, а негнутый getopt, как пишут в интернетах, не поддерживает длинные опции. Так что возможны проблемы с совместимостью.</span></p></body></html>